#!/usr/bin/env sage
# script to list the Sage packages
#  called with one argument which meight be either "installed" or "standard" or
#  "optional" or "experimental".

from __future__ import print_function
from sage.misc.package import _package_lists_from_mirror
import os, sys
from sage.env import SAGE_SPKG_INST

try:
    category = sys.argv[1]
except IndexError:
    sys.stderr.write("Usage: %s <package category>.\n" % sys.argv[0])
    sys.exit(1)

try:
    installed = set(os.listdir(SAGE_SPKG_INST))
except OSError:
    installed = set([])

if category == 'installed':
    print(*installed, sep='\n')
    sys.exit(0)

installed, not_installed = _package_lists_from_mirror(category)

print("\n{} packages:\n".format(category[0].upper() + category[1:]))

packages = ([(x,"installed"    ) for x in     installed]+
            [(x,"not installed") for x in not_installed])

for pkg_name,status in sorted(packages):
    print("{:.<40} {}".format(pkg_name + " ", status))

print()
print("Type 'sage -i package_name' to download and install a package.")

