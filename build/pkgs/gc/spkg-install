cd src

if [ "$SAGE_DEBUG" = "yes" ]; then
    echo "Building a debug version of BoehmGC."
    export CFLAGS="-O0 -g $CFLAGS"
else
    export CFLAGS="-O2 -g $CFLAGS"
fi

if [ "$SAGE64" = "yes" ]; then
    echo "Building a 64-bit version of BoehmGC."
    export CFLAGS="-m64 $CFLAGS"
fi

CONFIGURE_FLAGS="--enable-large-config"
if [ "$UNAME" = "CYGWIN" ]; then
    # See https://trac.sagemath.org/ticket/22694
    CONFIGURE_FLAGS="$CONFIGURE_FLAGS --enable-threads=posix --enable-handle-fork"
fi

sdh_configure $CONFIGURE_FLAGS
sdh_make
sdh_make_install
