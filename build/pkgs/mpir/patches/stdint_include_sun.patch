diff --git a/doc/mpir.texi b/doc/mpir.texi
index 22ab95db..f188b2b5 100644
--- a/doc/mpir.texi
+++ b/doc/mpir.texi
@@ -2895,8 +2895,10 @@ These functions assign new values to already initialized integers
 @deftypefunx void mpz_set_d (mpz_t @var{rop}, double @var{op})
 @deftypefunx void mpz_set_q (mpz_t @var{rop}, mpq_t @var{op})
 @deftypefunx void mpz_set_f (mpz_t @var{rop}, mpf_t @var{op})
-Set the value of @var{rop} from @var{op}. Note the intmax versions are only available
-if you include the @file{stdint.h} header before including @file{mpir.h}.
+Set the value of @var{rop} from @var{op}. Note that the @code{(u)intmax} versions are only available
+if @file{stdint.h} header exists. It is included conditionally and automatically on modern
+compilers supporting @code{__has_include()} macro, otherwise
+you need to include @file{stdint.h} before including @file{mpir.h}.
 
 @code{mpz_set_d}, @code{mpz_set_q} and @code{mpz_set_f} truncate @var{op} to
 make it an integer.
diff --git a/gmp-h.in b/gmp-h.in
index 5960664a..307893ce 100644
--- a/gmp-h.in
+++ b/gmp-h.in
@@ -28,6 +28,12 @@ along with the GNU MP Library.  If not, see http://www.gnu.org/licenses/.  */
 #include <stdarg.h>   /* on Sun Studio */
 #endif 
 
+#if defined(__has_include)  /* should work on gcc 5.x or better, clang, VS 2015+ */
+# if __has_include(<stdint.h>)
+#  include <stdint.h>
+# endif
+#endif
+
 #if defined (__cplusplus)
 
 #include <cstddef>     /* for size_t */
@@ -1239,7 +1245,8 @@ __GMP_DECLSPEC mpz_srcptr mpz_roinit_n (mpz_ptr, mp_srcptr, mp_size_t);
 
 /****** Integer (i.e. Z) routines for intmaax_t/uintmax_t types ******/
 
-/* if stdint.h is available -- n.b: we do NOT include stdint.h ourselves */
+/* if stdint.h is available -- n.b: we do NOT include stdint.h on old compilers   */
+/* we DO (safely) include stdint.h on modern compilers supporting __has_include() */
 #if defined(INTMAX_MAX)
 
 #define __GMP_BITS_PER_UINTMAX  (8*sizeof(uintmax_t))
